webpackJsonp([2],{"1a7W":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("4YfN"),a=s.n(i),r={name:"orderList",props:{orderList:{type:Array,default:[]}},data:function(){return{show:!1,show1:!1,show2:!1,editOrderId:"",isSelectedFirst:!0}},components:{},methods:{isOverdue:function(t){return(new Date).valueOf()-1e3*t>=6e5},orderListRemoveOverdue:function(t){return t.concat().filter(function(t){return(new Date).valueOf()-1e3*t.createTime<6e5})},delOrder:function(t){this.$emit("delOrder",t)},ensureTrade:function(){this.$emit("ensureTrade",this.editOrderId)},returnTrade:function(){this.$emit("returnTrade",{orderId:this.editOrderId,isSelectedFirst:this.isSelectedFirst})},ensureRefund:function(){this.$emit("ensureRefund",this.editOrderId)},goOrderDetail:function(t){t.status&&0!=t.status&&this.$router.push({name:"order-detail",params:{orderId:t.id}})}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list"},[t._l(t.orderList,function(e,i){return s("div",{key:e.id,staticClass:"list-item"},[s("div",{staticClass:"item-header"},[s("div",{staticClass:"shop-name"},[t._v("奔跑的蜗牛")]),t._v(" "),s("div",{staticClass:"right"},[s("van-icon",{attrs:{name:"arrow",size:".14rem"}})],1),t._v(" "),0!=e.status||t.isOverdue(e.createTime)?0==e.status&&t.isOverdue(e.createTime)?s("div",{staticClass:"status status-overdue status-del"},[t._v("已过期"),s("span",{on:{click:function(s){return t.delOrder(e.id)}}})]):1==e.status?s("div",{staticClass:"status status-loading"},[t._v("待发货")]):2==e.status?s("div",{staticClass:"status status-going"},[t._v("配送中")]):3==e.status?s("div",{staticClass:"status status-del"},[t._v("交易完成"),s("span",{on:{click:function(s){return t.delOrder(e.id)}}})]):-1==e.status?s("div",{staticClass:"status status-going"},[t._v("退款申请中")]):-2==e.status?s("div",{staticClass:"status status-going"},[t._v("退款中")]):-3==e.status?s("div",{staticClass:"status status-del"},[t._v("退款完成"),s("span",{on:{click:function(s){return t.delOrder(e.id)}}})]):t._e():s("div",{staticClass:"status status-loading status-del"},[t._v("待支付"),s("span",{on:{click:function(s){return t.delOrder(e.id)}}})])]),t._v(" "),s("div",{staticClass:"desc",on:{click:function(s){return t.goOrderDetail(e)}}},[s("div",{staticClass:"desc-img"},[s("img",{attrs:{src:e.productImage}})]),t._v(" "),s("div",{staticClass:"desc-info"},[s("div",{staticClass:"text"},[t._v(t._s(e.productTitle))]),t._v(" "),s("div",{staticClass:"price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("getParseInt")(e.payPrice))),s("span",[t._v("."+t._s(t._f("getFloat")(e.payPrice)))])]),t._v(" "),s("div",{staticClass:"inventory"},[t._v("数量："+t._s(e.number))]),t._v(" "),s("div",{staticClass:"createTime"},[t._v("下单时间："+t._s(t._f("formatDate")(e.createTime)))])])]),t._v(" "),s("div",{staticClass:"edit-btn",on:{click:function(s){t.editOrderId=e.id}}},[3==e.status||1==e.status?s("div",{staticClass:"refund",on:{click:function(e){t.show1=!0}}},[t._v("我要退款")]):2==e.status?s("div",{staticClass:"refund"},[s("button",{on:{click:function(e){t.show1=!0}}},[t._v("我要退款")]),t._v(" "),s("span",[t._v("|")]),t._v(" "),s("button",{on:{click:function(e){t.show=!0}}},[t._v("确认收货")])]):0!=e.status||t.isOverdue(e.createTime)?s("div",{staticClass:"refund"}):s("div",{staticClass:"refund"},[s("button",[t._v("立即支付")])])]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:i!=t.orderList.length-1,expression:"i != orderList.length-1"}],staticClass:"margin-line"})])}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"dialog-confirm"},[s("div",{staticClass:"t-title"},[s("button",{staticClass:"close",on:{click:function(e){t.show=!1}}},[s("van-icon",{attrs:{name:"cross",size:".14rem"}})],1),t._v(" "),s("span",[t._v("确认收货")])]),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"ok-btn",on:{click:t.ensureTrade}},[t._v("确 认")])]),t._v(" "),s("van-overlay",{attrs:{show:t.show,"z-index":10}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.show1,expression:"show1"}],staticClass:"dialog-refund"},[s("div",{staticClass:"t-title"},[s("button",{staticClass:"close",on:{click:function(e){t.show1=!1}}},[s("van-icon",{attrs:{name:"cross",size:".14rem"}})],1),t._v(" "),s("span",[t._v("退款申请")])]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"select1"},[s("h3",{class:t.isSelectedFirst?"select":"no-select",on:{click:function(e){t.isSelectedFirst=!0}}},[t._v("我要退款（无需退货）")]),t._v(" "),s("p",[t._v("没收到货，或与卖家协商同意不用退货只退款")])]),t._v(" "),s("div",{staticClass:"select2"},[s("h3",{class:t.isSelectedFirst?"no-select":"select",on:{click:function(e){t.isSelectedFirst=!1}}},[t._v("我要退货退款")]),t._v(" "),s("p",[t._v("已收到货，需要退还收到的货物")])])]),t._v(" "),s("div",{staticClass:"ok-btn",on:{click:t.returnTrade}},[t._v("确 认")])]),t._v(" "),s("van-overlay",{attrs:{show:t.show1,"z-index":10}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.show2,expression:"show2"}],staticClass:"dialog-confirm"},[s("div",{staticClass:"t-title"},[s("button",{staticClass:"close",on:{click:function(e){t.show2=!1}}},[s("van-icon",{attrs:{name:"cross",size:".14rem"}})],1),t._v(" "),s("span",[t._v("确认退款")])]),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"ok-btn",on:{click:t.ensureRefund}},[t._v("确 认")])])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("p",[this._v("成功收到商品，并确认收货！")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("p",[this._v("成功收到退款，并确认退款！")])])}]};var o=s("C7Lr")(r,n,!1,function(t){s("uT9V")},"data-v-6419d6e7",null).exports,c=s("2bvH"),d={name:"",data:function(){return{searchValue:"",active:0,tabTitle:["全部","待支付","待发货","待收货","退款订单"],orderList:[],page:1,type:99,total:10,loading:!1,finished:!1,isEnd:!1}},components:{orderList:o},methods:a()({},Object(c.b)(["getUserId"]),Object(c.c)(["setBackName"]),{stopScroll:function(){document.body.addEventListener("touchmove",function(t){(t=t||event).stopPropagation(),t.preventDefault()})},removeStopScroll:function(){document.body.removeEventListener("touchmove",function(t){(t=t||event).stopPropagation(),t.preventDefault()})},reload:function(){var t={userId:this.getUserId(),type:this.type};this.page=1,this.total=10,this.getOrderList(t)},onDelOrder:function(t){var e=this;this.$dialog.confirm({message:"确定删除吗？",confirmButtonColor:"#FFD200"}).then(function(){var s={orderId:t,userId:e.getUserId()};e.$http.delOrder(s).then(function(s){e.$toast.success("删除成功"),e.orderList=e.orderList.filter(function(e){return e.id!==t})})}).catch(function(){})},onEnsureTrade:function(t){var e=this,s={userId:this.getUserId(),orderId:t};this.$http.ensureTrade(s).then(function(t){e.$toast.success("收货成功"),e.$refs.listComponent[0].show=!1,e.$forceUpdate();var s=null;s=setTimeout(function(){e.reload(),clearTimeout(s)},1e3)})},onReturnTrade:function(t){var e=this,s={userId:this.getUserId(),orderId:t.orderId,remark:t.isSelectedFirst?"我要退款（无需退货）":"我要退货退款"};this.$http.returnTrade(s).then(function(t){e.$toast.success("退款申请成功"),e.$refs.listComponent[0].show1=!1,e.$forceUpdate();var s=null;s=setTimeout(function(){e.reload(),clearTimeout(s)},1e3)})},onEnsureRefund:function(t){var e=this,s={promoter:1,userId:this.getUserId(),orderId:t};this.$http.userEnsureRefund(s).then(function(t){if(t&&1===t.code){e.$toast.success("确认退款成功"),e.$refs.listComponent[0].show2=!1,e.$forceUpdate();var s=null;s=setTimeout(function(){e.reload(),clearTimeout(s)},1e3)}})},getOrderList:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments[2];this.loading=!0,this.$http.getOrderList(t).then(function(t){if(t&&1===t.code){var a=t.data.order;e.orderList=1==s?a:e.orderList.concat(a),i&&1===i&&(e.orderList=e.orderList.filter(function(t){return(new Date).valueOf()-1e3*t.createTime<6e5}));var r=t.data.total;e.total>=r&&(e.finished=!0)}e.loading=!1})},onLoading:function(){this.page=this.page+1,this.total=this.total+10;var t={userId:this.getUserId(),type:this.type,page:this.page};this.getOrderList(t,this.page)},onTabChange:function(t){switch(t){case 1:this.type=0;break;case 2:this.type=1;break;case 3:this.type=2;break;case 4:this.type=-99;break;default:this.type=99}this.page=1,this.total=10;var e={userId:this.getUserId(),type:this.type};this.getOrderList(e,1,t)},onSearch:function(){if(""!=this.searchValue){var t={userId:this.getUserId(),content:this.searchValue,type:this.type};this.page=1,this.total=10,this.getOrderList(t)}},goOrderDetail:function(t){t.status&&0!=t.status&&this.$router.push({name:"order-detail",params:{orderId:t.id}})}}),mounted:function(){this.setBackName(null);var t={userId:this.getUserId()};this.getOrderList(t)}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-list"},[s("div",{staticClass:"nav"},[s("div",{staticClass:"search"},[s("van-search",{staticClass:"v-search",attrs:{placeholder:"搜索","show-action":"",shape:"round"},on:{search:t.onSearch,focus:t.stopScroll,blur:t.removeStopScroll},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},[s("div",{attrs:{slot:"action"},on:{click:t.onSearch},slot:"action"},[t._v("搜索")])])],1),t._v(" "),s("div",{staticClass:"tab"},[s("van-tabs",{attrs:{type:"line",border:!1,"title-active-color":"#F7B500","title-inactive-color":"#909090",color:"#F7B500","line-width":".2rem","swipe-threshold":5},on:{change:t.onTabChange},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabTitle,function(e){return s("van-tab",{key:e,attrs:{title:e}},[s("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1},on:{load:t.onLoading},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("order-list",{ref:"listComponent",refInFor:!0,attrs:{orderList:t.orderList},on:{delOrder:t.onDelOrder,ensureTrade:t.onEnsureTrade,returnTrade:t.onReturnTrade,ensureRefund:t.onEnsureRefund}})],1)],1)}),1),t._v(" "),s("div",{staticClass:"autoFlex"})],1)]),t._v(" "),s("div",{staticClass:"address-btn",on:{click:function(e){return t.$router.push("/my-address")}}},[t._v("收货地址")])])},staticRenderFns:[]};var u=s("C7Lr")(d,l,!1,function(t){s("yqMg"),s("29g0")},"data-v-57516a04",null);e.default=u.exports},"29g0":function(t,e){},uT9V:function(t,e){},yqMg:function(t,e){}});